(this.webpackJsonpmusic=this.webpackJsonpmusic||[]).push([[0],{1658:function(e,t,n){},1666:function(e,t,n){},1671:function(e,t,n){"use strict";n.r(t);var i=n(0),a=n.n(i),o=n(17),c=n.n(o),r=n(15),s=n(12),l=n(21),d=n(20),u=n(6),h=n(27),g=n.n(h),f=n(41),m=n(102),b=n.n(m),j=n(103),v=n.n(j),p=n(1694),x=n(1690),y=n(1691),w=n(1692),O=n(119),S=n.n(O),C=n(120),k=n.n(C),M=n(122),A=n.n(M),D=n(123),T=n.n(D),V=n(124),U=n.n(V),E=n(125),N=n.n(E),F=n(121),L=n.n(F),W=n(126),R=n.n(W),J=n(1693),P=(n(1656),n(1695)),B=n(44),H=(n(1657),n(1658),n(4)),I={},z={iceServers:[{urls:"stun:stun.l.google.com:19302"}]},q=null,G=null,Y=0,K=function(e){Object(l.a)(n,e);var t=Object(d.a)(n);function n(e){var i;return Object(r.a)(this,n),(i=t.call(this,e)).getPermissions=Object(f.a)(g.a.mark((function e(){return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,navigator.mediaDevices.getUserMedia({video:!0}).then((function(){return i.videoAvailable=!0})).catch((function(){return i.videoAvailable=!1}));case 3:return e.next=5,navigator.mediaDevices.getUserMedia({audio:!0}).then((function(){return i.audioAvailable=!0})).catch((function(){return i.audioAvailable=!1}));case 5:navigator.mediaDevices.getDisplayMedia?i.setState({screenAvailable:!0}):i.setState({screenAvailable:!1}),(i.videoAvailable||i.audioAvailable)&&navigator.mediaDevices.getUserMedia({video:i.videoAvailable,audio:i.audioAvailable}).then((function(e){window.localStream=e,i.localVideoref.current.srcObject=e})).then((function(e){})).catch((function(e){return console.log(e)})),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),console.log(e.t0);case 12:case"end":return e.stop()}}),e,null,[[0,9]])}))),i.getMedia=function(){i.setState({video:i.videoAvailable,audio:i.audioAvailable},(function(){i.getUserMedia(),i.connectToSocketServer()}))},i.getUserMedia=function(){if(i.state.video&&i.videoAvailable||i.state.audio&&i.audioAvailable)navigator.mediaDevices.getUserMedia({video:i.state.video,audio:i.state.audio}).then(i.getUserMediaSuccess).then((function(e){})).catch((function(e){return console.log(e)}));else try{i.localVideoref.current.srcObject.getTracks().forEach((function(e){return e.stop()}))}catch(e){}},i.getUserMediaSuccess=function(e){try{window.localStream.getTracks().forEach((function(e){return e.stop()}))}catch(a){console.log(a)}window.localStream=e,i.localVideoref.current.srcObject=e;var t=function(e){if(e===G)return"continue";I[e].addStream(window.localStream),I[e].createOffer().then((function(t){I[e].setLocalDescription(t).then((function(){q.emit("signal",e,JSON.stringify({sdp:I[e].localDescription}))})).catch((function(e){return console.log(e)}))}))};for(var n in I)t(n);e.getTracks().forEach((function(e){return e.onended=function(){i.setState({video:!1,audio:!1},(function(){try{i.localVideoref.current.srcObject.getTracks().forEach((function(e){return e.stop()}))}catch(a){console.log(a)}window.localStream=function(){var e;return new MediaStream([(e=i).black.apply(e,arguments),i.silence()])}(),i.localVideoref.current.srcObject=window.localStream;var e=function(e){I[e].addStream(window.localStream),I[e].createOffer().then((function(t){I[e].setLocalDescription(t).then((function(){q.emit("signal",e,JSON.stringify({sdp:I[e].localDescription}))})).catch((function(e){return console.log(e)}))}))};for(var t in I)e(t)}))}}))},i.getDislayMedia=function(){i.state.screen&&navigator.mediaDevices.getDisplayMedia&&navigator.mediaDevices.getDisplayMedia({video:!0,audio:!0}).then(i.getDislayMediaSuccess).then((function(e){})).catch((function(e){return console.log(e)}))},i.getDislayMediaSuccess=function(e){try{window.localStream.getTracks().forEach((function(e){return e.stop()}))}catch(a){console.log(a)}window.localStream=e,i.localVideoref.current.srcObject=e;var t=function(e){if(e===G)return"continue";I[e].addStream(window.localStream),I[e].createOffer().then((function(t){I[e].setLocalDescription(t).then((function(){q.emit("signal",e,JSON.stringify({sdp:I[e].localDescription}))})).catch((function(e){return console.log(e)}))}))};for(var n in I)t(n);e.getTracks().forEach((function(e){return e.onended=function(){i.setState({screen:!1},(function(){try{i.localVideoref.current.srcObject.getTracks().forEach((function(e){return e.stop()}))}catch(a){console.log(a)}window.localStream=function(){var e;return new MediaStream([(e=i).black.apply(e,arguments),i.silence()])}(),i.localVideoref.current.srcObject=window.localStream,i.getUserMedia()}))}}))},i.gotMessageFromServer=function(e,t){var n=JSON.parse(t);e!==G&&(n.sdp&&I[e].setRemoteDescription(new RTCSessionDescription(n.sdp)).then((function(){"offer"===n.sdp.type&&I[e].createAnswer().then((function(t){I[e].setLocalDescription(t).then((function(){q.emit("signal",e,JSON.stringify({sdp:I[e].localDescription}))})).catch((function(e){return console.log(e)}))})).catch((function(e){return console.log(e)}))})).catch((function(e){return console.log(e)})),n.ice&&I[e].addIceCandidate(new RTCIceCandidate(n.ice)).catch((function(e){return console.log(e)})))},i.changeCssVideos=function(e){var t="30%";30*e.offsetWidth/100<300&&(t="300px");var n=String(100/Y)+"%",i="";0===Y||1===Y?(i="100%",n="100%"):2===Y?(i="45%",n="100%"):3===Y||4===Y?(i="35%",n="50%"):i=String(100/Y)+"%";for(var a=e.querySelectorAll("video"),o=0;o<a.length;++o)a[o].style.minWidth=t,a[o].style.minHeight="40%",a[o].style.setProperty("width",i),a[o].style.setProperty("height",n);return{minWidth:t,minHeight:"40%",width:i,height:n}},i.connectToSocketServer=function(){(q=b.a.connect("https://video.sebastienbiollo.com",{secure:!0})).on("signal",i.gotMessageFromServer),q.on("connect",(function(){q.emit("join-call",window.location.href),G=q.id,q.on("chat-message",i.addMessage),q.on("user-left",(function(e){var t=document.querySelector('[data-socket="'.concat(e,'"]'));if(null!==t){Y--,t.parentNode.removeChild(t);var n=document.getElementById("main");i.changeCssVideos(n)}})),q.on("user-joined",(function(e,t){if(t.forEach((function(e){if(I[e]=new RTCPeerConnection(z),I[e].onicecandidate=function(t){null!=t.candidate&&q.emit("signal",e,JSON.stringify({ice:t.candidate}))},I[e].onaddstream=function(n){var a=document.querySelector('[data-socket="'.concat(e,'"]'));if(null!==a)a.srcObject=n.stream;else{Y=t.length;var o=document.getElementById("main"),c=i.changeCssVideos(o),r=document.createElement("video"),s={minWidth:c.minWidth,minHeight:c.minHeight,maxHeight:"100%",margin:"10px",borderStyle:"solid",borderColor:"#bdbdbd",objectFit:"fill"};for(var l in s)r.style[l]=s[l];r.style.setProperty("width",c.width),r.style.setProperty("height",c.height),r.setAttribute("data-socket",e),r.srcObject=n.stream,r.autoplay=!0,r.playsinline=!0,o.appendChild(r)}},void 0!==window.localStream&&null!==window.localStream)I[e].addStream(window.localStream);else{window.localStream=function(){var e;return new MediaStream([(e=i).black.apply(e,arguments),i.silence()])}(),I[e].addStream(window.localStream)}})),e===G){var n=function(e){if(e===G)return"continue";try{I[e].addStream(window.localStream)}catch(t){}I[e].createOffer().then((function(t){I[e].setLocalDescription(t).then((function(){q.emit("signal",e,JSON.stringify({sdp:I[e].localDescription}))})).catch((function(e){return console.log(e)}))}))};for(var a in I)n(a)}}))}))},i.silence=function(){var e=new AudioContext,t=e.createOscillator(),n=t.connect(e.createMediaStreamDestination());return t.start(),e.resume(),Object.assign(n.stream.getAudioTracks()[0],{enabled:!1})},i.black=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.width,n=void 0===t?640:t,i=e.height,a=void 0===i?480:i,o=Object.assign(document.createElement("canvas"),{width:n,height:a});o.getContext("2d").fillRect(0,0,n,a);var c=o.captureStream();return Object.assign(c.getVideoTracks()[0],{enabled:!1})},i.handleVideo=function(){return i.setState({video:!i.state.video},(function(){return i.getUserMedia()}))},i.handleAudio=function(){return i.setState({audio:!i.state.audio},(function(){return i.getUserMedia()}))},i.handleScreen=function(){return i.setState({screen:!i.state.screen},(function(){return i.getDislayMedia()}))},i.handleEndCall=function(){try{i.localVideoref.current.srcObject.getTracks().forEach((function(e){return e.stop()}))}catch(e){}window.location.href="/"},i.openChat=function(){return i.setState({showModal:!0,newmessages:0})},i.closeChat=function(){return i.setState({showModal:!1})},i.handleMessage=function(e){return i.setState({message:e.target.value})},i.addMessage=function(e,t,n){i.setState((function(n){return{messages:[].concat(Object(u.a)(n.messages),[{sender:t,data:e}])}})),n!==G&&i.setState({newmessages:i.state.newmessages+1})},i.handleUsername=function(e){return i.setState({username:e.target.value})},i.sendMessage=function(){q.emit("chat-message",i.state.message,i.state.username),i.setState({message:"",sender:i.state.username})},i.copyUrl=function(){var e=window.location.href;if(navigator.clipboard)navigator.clipboard.writeText(e).then((function(){J.b.success("Link copied to clipboard!")}),(function(){J.b.error("Failed to copy")}));else{var t=document.createElement("textarea");t.value=e,document.body.appendChild(t),t.focus(),t.select();try{document.execCommand("copy"),J.b.success("Link copied to clipboard!")}catch(n){J.b.error("Failed to copy")}document.body.removeChild(t)}},i.connect=function(){return i.setState({askForUsername:!1},(function(){return i.getMedia()}))},i.isChrome=function(){var e=(navigator&&(navigator.userAgent||"")).toLowerCase(),t=(navigator&&(navigator.vendor||"")).toLowerCase();return null!==(/google inc/.test(t)?e.match(/(?:chrome|crios)\/(\d+)/):null)},i.localVideoref=a.a.createRef(),i.videoAvailable=!1,i.audioAvailable=!1,i.state={video:!1,audio:!1,screen:!1,showModal:!1,screenAvailable:!1,messages:[],message:"",newmessages:0,askForUsername:!0,username:v.a.internet.userName()},I={},i.getPermissions(),i}return Object(s.a)(n,[{key:"render",value:function(){var e=this;return!1===this.isChrome()?Object(H.jsx)("div",{style:{background:"white",width:"30%",height:"auto",padding:"20px",minWidth:"400px",textAlign:"center",margin:"auto",marginTop:"50px",justifyContent:"center"},children:Object(H.jsx)("h1",{children:"Sorry, this works only with Google Chrome"})}):Object(H.jsx)("div",{children:!0===this.state.askForUsername?Object(H.jsxs)("div",{children:[Object(H.jsxs)("div",{style:{background:"white",width:"30%",height:"auto",padding:"20px",minWidth:"400px",textAlign:"center",margin:"auto",marginTop:"50px",justifyContent:"center"},children:[Object(H.jsx)("p",{style:{margin:0,fontWeight:"bold",paddingRight:"50px"},children:"Set your username"}),Object(H.jsx)(p.a,{placeholder:"Username",value:this.state.username,onChange:function(t){return e.handleUsername(t)}}),Object(H.jsx)(x.a,{variant:"contained",color:"primary",onClick:this.connect,style:{margin:"20px"},children:"Connect"})]}),Object(H.jsx)("div",{style:{justifyContent:"center",textAlign:"center",paddingTop:"40px",alignItems:"center"},children:Object(H.jsx)("video",{id:"my-video",ref:this.localVideoref,autoPlay:!0,muted:!0,style:{borderStyle:"solid",borderColor:"#bdbdbd",objectFit:"fill",width:"30%",height:"30%"}})})]}):Object(H.jsxs)("div",{children:[Object(H.jsxs)("div",{className:"btn-down",style:{backgroundColor:"whitesmoke",color:"whitesmoke",textAlign:"center"},children:[Object(H.jsx)(y.a,{style:{color:"#424242"},onClick:this.handleVideo,children:!0===this.state.video?Object(H.jsx)(S.a,{}):Object(H.jsx)(k.a,{})}),Object(H.jsx)(y.a,{style:{color:"#f44336"},onClick:this.handleEndCall,children:Object(H.jsx)(L.a,{})}),Object(H.jsx)(y.a,{style:{color:"#424242"},onClick:this.handleAudio,children:!0===this.state.audio?Object(H.jsx)(A.a,{}):Object(H.jsx)(T.a,{})}),!0===this.state.screenAvailable?Object(H.jsx)(y.a,{style:{color:"#424242"},onClick:this.handleScreen,children:!0===this.state.screen?Object(H.jsx)(U.a,{}):Object(H.jsx)(N.a,{})}):null,Object(H.jsx)(w.a,{badgeContent:this.state.newmessages,max:999,color:"secondary",onClick:this.openChat,children:Object(H.jsx)(y.a,{style:{color:"#424242"},onClick:this.openChat,children:Object(H.jsx)(R.a,{})})})]}),Object(H.jsxs)(B.a,{show:this.state.showModal,onHide:this.closeChat,style:{zIndex:"999999"},children:[Object(H.jsx)(B.a.Header,{closeButton:!0,children:Object(H.jsx)(B.a.Title,{children:"Chat Room"})}),Object(H.jsx)(B.a.Body,{style:{overflow:"auto",overflowY:"auto",height:"400px",textAlign:"left"},children:this.state.messages.length>0?this.state.messages.map((function(e,t){return Object(H.jsx)("div",{style:{textAlign:"left"},children:Object(H.jsxs)("p",{style:{wordBreak:"break-all"},children:[Object(H.jsx)("b",{children:e.sender}),": ",e.data]})},t)})):Object(H.jsx)("p",{children:"No message yet"})}),Object(H.jsxs)(B.a.Footer,{className:"div-send-msg",children:[Object(H.jsx)(p.a,{placeholder:"Message",value:this.state.message,onChange:function(t){return e.handleMessage(t)}}),Object(H.jsx)(x.a,{variant:"contained",color:"primary",onClick:this.sendMessage,children:"Send"})]})]}),Object(H.jsxs)("div",{className:"container",children:[Object(H.jsxs)("div",{style:{paddingTop:"20px"},children:[Object(H.jsx)(p.a,{value:window.location.href,disable:"true"}),Object(H.jsx)(x.a,{style:{backgroundColor:"#3f51b5",color:"whitesmoke",marginLeft:"20px",marginTop:"10px",width:"120px",fontSize:"10px"},onClick:this.copyUrl,children:"Copy invite link"})]}),Object(H.jsx)(P.a,{id:"main",className:"flex-container",style:{margin:0,padding:0},children:Object(H.jsx)("video",{id:"my-video",ref:this.localVideoref,autoPlay:!0,muted:!0,style:{borderStyle:"solid",borderColor:"#bdbdbd",margin:"10px",objectFit:"fill",width:"50%",height:"50%"}})})]})]})})}}]),n}(i.Component),Q=n(127),X=n.n(Q),Z=(n(1666),function(e){Object(l.a)(n,e);var t=Object(d.a)(n);function n(e){var i;return Object(r.a)(this,n),(i=t.call(this,e)).handleChange=function(e){return i.setState({url:e.target.value})},i.join=function(){if(""!==i.state.url){var e=i.state.url.split("/");window.location.href="/".concat(e[e.length-1])}else{e=Math.random().toString(36).substring(2,7);window.location.href="/".concat(e)}},i.state={url:""},i}return Object(s.a)(n,[{key:"render",value:function(){var e=this;return Object(H.jsxs)("div",{className:"container2",children:[Object(H.jsxs)("div",{style:{display:" none",fontSize:"14px",background:"white",width:"10%",textAlign:"center",margin:"auto",marginBottom:"10px"},children:["Source code:",Object(H.jsx)(y.a,{style:{color:"black"},onClick:function(){return window.location.href="https://github.com/0x5eba/Video-Meeting"},children:Object(H.jsx)(X.a,{})})]}),Object(H.jsxs)("div",{children:[Object(H.jsx)("h1",{style:{fontSize:"45px"},children:"Video Meeting"}),Object(H.jsx)("p",{style:{fontWeight:"200"},children:"Video conference website that lets you stay in touch with all your friends."})]}),Object(H.jsxs)("div",{style:{background:"white",width:"30%",height:"auto",padding:"20px",minWidth:"400px",textAlign:"center",margin:"auto",marginTop:"100px"},children:[Object(H.jsx)("p",{style:{margin:0,fontWeight:"bold",paddingRight:"50px"},children:"Start or join a meeting"}),Object(H.jsx)(p.a,{placeholder:"URL",onChange:function(t){return e.handleChange(t)}}),Object(H.jsx)(x.a,{variant:"contained",color:"primary",onClick:this.join,style:{margin:"20px"},children:"Go"})]})]})}}]),n}(i.Component)),$=n(128),_=n(14),ee=function(e){Object(l.a)(n,e);var t=Object(d.a)(n);function n(){return Object(r.a)(this,n),t.apply(this,arguments)}return Object(s.a)(n,[{key:"render",value:function(){return Object(H.jsx)(H.Fragment,{children:Object(H.jsx)("div",{children:Object(H.jsx)($.a,{children:Object(H.jsxs)(_.c,{children:[Object(H.jsx)(_.a,{path:"/",exact:!0,component:Z}),Object(H.jsx)(_.a,{path:"/:url",component:K})]})})})})}}]),n}(i.Component);c.a.render(Object(H.jsx)(ee,{}),document.getElementById("root"))}},[[1671,1,2]]]);
//# sourceMappingURL=main.fe00feaa.chunk.js.map